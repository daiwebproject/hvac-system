{{ define "content" }}
<div x-data="techDashboard()" x-init="initDashboard()" class="min-h-screen bg-gray-50">

    <div
        class="bg-gradient-to-br from-blue-700 to-blue-900 rounded-b-[2rem] shadow-xl text-white relative overflow-hidden">
        <div class="absolute top-0 right-0 opacity-10 pointer-events-none">
            <i class="fas fa-tools text-9xl -mr-10 -mt-10 transform rotate-12"></i>
        </div>

        <div class="p-6 pt-8 pb-12">
            <div class="flex justify-between items-start mb-6">
                <div>
                    <p class="text-blue-200 text-sm font-medium">Xin chào,</p>
                    <h2 class="text-2xl font-bold tracking-tight">{{.Auth.Name}}</h2>
                </div>
                <div class="relative p-2 rounded-full hover:bg-white/10 transition cursor-pointer">
                    <i class="fas fa-bell text-xl"></i>
                    <span
                        class="absolute top-2 right-2 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-blue-900"></span>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div class="bg-white/10 backdrop-blur-md p-4 rounded-2xl border border-white/10">
                    <p class="text-xs text-blue-200 mb-1">Hoàn thành hôm nay</p>
                    <p class="text-2xl font-bold">{{.CompletedTodayCount}} <span class="text-sm font-normal">ca</span>
                    </p>
                </div>
                <div class="bg-white/10 backdrop-blur-md p-4 rounded-2xl border border-white/10">
                    <p class="text-xs text-blue-200 mb-1">Thu nhập ước tính</p>
                    <p class="text-2xl font-bold text-yellow-300">
                        {{if .TodayEarnings}}{{.TodayEarnings | printf "%.0f"}}k{{else}}0{{end}}
                    </p>
                </div>
            </div>
        </div>

        <div class="bg-black/20 px-6 py-2 text-xs flex items-center gap-2 text-blue-100">
            <i class="fas fa-lightbulb text-yellow-300"></i>
            <span x-text="getTodayTip()" class="truncate"></span>
        </div>
    </div>

    <div class="px-4 -mt-6 relative z-10" x-data="{ activeTab: 'new' }">
        <div class="bg-white rounded-xl shadow-lg p-1.5 flex justify-between">
            <button class="flex-1 py-2.5 rounded-lg text-sm font-medium transition-all flex flex-col items-center gap-1"
                :class="activeTab === 'new' ? 'bg-blue-50 text-blue-700 shadow-sm' : 'text-gray-500 hover:bg-gray-50'"
                @click="activeTab = 'new'" hx-get="/api/tech/jobs/list?status=new" hx-target="#job-list-container"
                hx-swap="innerHTML">
                <i class="fas fa-bell"></i>
                <span class="text-xs">Mới giao</span>
            </button>

            <button class="flex-1 py-2.5 rounded-lg text-sm font-medium transition-all flex flex-col items-center gap-1"
                :class="activeTab === 'active' ? 'bg-amber-50 text-amber-700 shadow-sm' : 'text-gray-500 hover:bg-gray-50'"
                @click="activeTab = 'active'" hx-get="/api/tech/jobs/list?status=active" hx-target="#job-list-container"
                hx-swap="innerHTML">
                <i class="fas fa-person-digging"></i>
                <span class="text-xs">Đang làm</span>
            </button>

            <button class="flex-1 py-2.5 rounded-lg text-sm font-medium transition-all flex flex-col items-center gap-1"
                :class="activeTab === 'completed' ? 'bg-green-50 text-green-700 shadow-sm' : 'text-gray-500 hover:bg-gray-50'"
                @click="activeTab = 'completed'" hx-get="/api/tech/jobs/list?status=completed"
                hx-target="#job-list-container" hx-swap="innerHTML">
                <i class="fas fa-check-circle"></i>
                <span class="text-xs">Lịch sử</span>
            </button>
        </div>
    </div>

    <div class="px-4 mt-6 pb-24">
        <div class="htmx-indicator flex justify-center py-4">
            <span class="loading loading-dots loading-lg text-blue-600"></span>
        </div>

        <div id="job-list-container" class="space-y-4" hx-get="/api/tech/jobs/list?status=new"
            hx-trigger="load, statusUpdated from:body" hx-swap="innerHTML">

            <div class="animate-pulse space-y-4">
                <div class="h-32 bg-gray-200 rounded-xl"></div>
                <div class="h-32 bg-gray-200 rounded-xl"></div>
            </div>
        </div>
    </div>
</div>
{{ end }}