{{/*
Job Action Buttons Partial

Conditionally displays action buttons based on job status
Used in job_detail.html
*/}}
{{ define "tech/job_actions_bar" }}
<div class="fixed bottom-0 left-0 right-0 glass-nav border-t border-gray-200/50 p-4 pb-safe z-50">
    <div class="max-w-lg mx-auto flex gap-3">

        <!-- Start Moving Button (assigned/pending status) -->
        <template x-if="status === 'assigned' || status === 'pending'">
            <button @click="updateStatusAPI('moving')" :disabled="loading"
                class="btn btn-primary w-full shadow-xl shadow-blue-600/20 text-lg font-bold rounded-2xl h-14">
                <span x-show="!loading" class="flex items-center gap-2">
                    <i class="fa-solid fa-person-walking-arrow-right"></i> Bắt đầu di chuyển
                </span>
                <span x-show="loading" class="loading loading-spinner"></span>
            </button>
        </template>

        <!-- Arrived / Check-in Button (moving status) -->
        <template x-if="status === 'moving'">
            <button @click="checkIn()" :disabled="loading"
                class="btn btn-warning w-full shadow-xl shadow-yellow-500/20 text-lg font-bold rounded-2xl h-14 text-white">
                <span x-show="!loading" class="flex items-center gap-2">
                    <i class="fa-solid fa-location-dot"></i> Đã đến nơi
                </span>
                <span x-show="loading" class="loading loading-spinner"></span>
            </button>
        </template>

        <!-- Start Working Button (arrived status) -->
        <template x-if="status === 'arrived'">
            <div class="flex gap-3 flex-1">
                <button @click="updateStatusAPI('working')" :disabled="loading"
                    class="btn btn-primary flex-1 shadow-xl shadow-blue-600/20 text-base font-bold rounded-2xl h-14">
                    <span x-show="!loading" class="flex items-center gap-2">
                        <i class="fa-solid fa-screwdriver-wrench"></i> Bắt đầu làm
                    </span>
                    <span x-show="loading" class="loading loading-spinner"></span>
                </button>
                <button @click="cancelReason = 'customer_not_home'; showCancelModal = true" :disabled="loading"
                    class="btn btn-error btn-outline shadow-none rounded-2xl h-14 aspect-square flex items-center justify-center p-0"
                    title="Khách vắng nhà">
                    <i class="fa-solid fa-user-xmark text-xl"></i>
                </button>
            </div>
        </template>

        <!-- Complete Job Button (working status) -->
        <template x-if="status === 'working'">
            <a href="/tech/job/{{.JobId}}/complete"
                class="btn btn-success text-white w-full shadow-xl shadow-green-500/20 text-lg font-bold rounded-2xl h-14">
                <i class="fa-solid fa-clipboard-check"></i> Hoàn thành & Nghiệm thu
            </a>
        </template>

        <!-- Cancel Button (all non-completed/cancelled statuses) -->
        <button @click="showCancelModal = true"
            class="btn btn-circle btn-ghost text-red-500 hover:bg-red-50 absolute -top-16 right-4 shadow-lg bg-white border border-gray-100"
            :class="status === 'completed' || status === 'cancelled' ? 'hidden' : ''" title="Hủy đơn">
            <i class="fa-solid fa-ban text-lg"></i>
        </button>

    </div>
</div>
{{ end }}